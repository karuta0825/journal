+++
title = "emacsでpythonによる文芸的プログラミング"
author = ["karuta"]
tags = ["emacs", "python"]
draft = true
+++

emacsのorgでpythonの学習をしていきたいのでその設定方法を残しておこう  

<!--more-->  

python, ipythonがインストールされており、numpyやmatplotlibも使える環境が整っていることを前提に進める。  

まずは `ob-ipython` をemacsでインストールする  

```elisp
package install ob-ipython
```

init.elなどで以下の設定をおこない、org-babelからob-ipythonが利用できるようにする  

```elisp
(require 'ob-ipython)

(org-babel-do-load-languages
 'org-babel-load-languages
 '((ipython . t)))
```

さらに追加として以下も設定しておく。  

```elisp
;; orgファイルオープン時に画像ファイルをインライン表示
(setq org-startup-with-inline-images t)

;; org-babel実行後画像ファイルがあればインライン表示
(add-hook 'org-babel-after-execute-hook 'org-display-inline-images 'append)
```

これで設定完了したので実際にpythonを実行してみる  

```org
#+BEGIN_SRC ipython :session :results drawer :exports both 
import matplotlib.pyplot as plt
import numpy as np
plt.hist(np.random.randn(20000), bins=200)
```

\#+END\_SRC  

このように書いて `C-c C-c` を押すとヒストグラムデータと画像が表示される。  

```text
(array([  1.,   0.,   0.,   0.,   0.,   1.,   0.,   0.,   0.,   0.,   0.,
0.,   0.,   0.,   2.,   1.,   1.,   0.,   1.,   1.,   1.,   1.,
3.,   2.,   2.,   2.,   0.,   0.,   4.,   3.,   3.,   6.,   5.,
6.,   6.,   8.,   5.,  13.,   3.,   9.,  14.,  11.,  13.,  16.,
17.,  19.,  18.,  29.,  37.,  32.,  23.,  38.,  29.,  44.,  47.,
60.,  57.,  57.,  66.,  62.,  69.,  78.,  92., 109.,  85.,  90.,
101., 135., 129., 140., 126., 147., 152., 178., 169., 211., 164.,
184., 226., 210., 216., 228., 244., 276., 271., 244., 276., 273.,
289., 297., 296., 286., 316., 302., 344., 326., 311., 301., 332.,
351., 336., 326., 343., 335., 368., 339., 311., 319., 337., 345.,
319., 339., 271., 304., 283., 257., 283., 275., 265., 278., 263.,
228., 222., 233., 222., 199., 182., 200., 163., 151., 176., 162.,
162., 127., 114., 105., 111., 127., 104.,  92.,  95.,  94.,  83.,
70.,  69.,  59.,  52.,  34.,  50.,  44.,  37.,  40.,  39.,  39.,
29.,  21.,  24.,  20.,  22.,  15.,  17.,  17.,  11.,   9.,   8.,
5.,   9.,   6.,   3.,  10.,   6.,   4.,   3.,   4.,   3.,   1.,
3.,   1.,   1.,   0.,   2.,   1.,   0.,   2.,   3.,   1.,   0.,
0.,   2.,   0.,   0.,   0.,   1.,   0.,   1.,   0.,   0.,   0.,
0.,   1.]),
array([-4.27887518, -4.23674377, -4.19461236, -4.15248095, -4.11034954,
-4.06821813, -4.02608672, -3.98395531, -3.9418239 , -3.89969248,
-3.85756107, -3.81542966, -3.77329825, -3.73116684, -3.68903543,
-3.64690402, -3.60477261, -3.5626412 , -3.52050979, -3.47837838,
-3.43624697, -3.39411555, -3.35198414, -3.30985273, -3.26772132,
-3.22558991, -3.1834585 , -3.14132709, -3.09919568, -3.05706427,
-3.01493286, -2.97280145, -2.93067003, -2.88853862, -2.84640721,
-2.8042758 , -2.76214439, -2.72001298, -2.67788157, -2.63575016,
-2.59361875, -2.55148734, -2.50935593, -2.46722451, -2.4250931 ,
-2.38296169, -2.34083028, -2.29869887, -2.25656746, -2.21443605,
-2.17230464, -2.13017323, -2.08804182, -2.04591041, -2.00377899,
-1.96164758, -1.91951617, -1.87738476, -1.83525335, -1.79312194,
-1.75099053, -1.70885912, -1.66672771, -1.6245963 , -1.58246489,
-1.54033347, -1.49820206, -1.45607065, -1.41393924, -1.37180783,
-1.32967642, -1.28754501, -1.2454136 , -1.20328219, -1.16115078,
-1.11901937, -1.07688796, -1.03475654, -0.99262513, -0.95049372,
-0.90836231, -0.8662309 , -0.82409949, -0.78196808, -0.73983667,
-0.69770526, -0.65557385, -0.61344244, -0.57131102, -0.52917961,
-0.4870482 , -0.44491679, -0.40278538, -0.36065397, -0.31852256,
-0.27639115, -0.23425974, -0.19212833, -0.14999692, -0.1078655 ,
-0.06573409, -0.02360268,  0.01852873,  0.06066014,  0.10279155,
0.14492296,  0.18705437,  0.22918578,  0.27131719,  0.3134486 ,
0.35558002,  0.39771143,  0.43984284,  0.48197425,  0.52410566,
0.56623707,  0.60836848,  0.65049989,  0.6926313 ,  0.73476271,
0.77689412,  0.81902554,  0.86115695,  0.90328836,  0.94541977,
0.98755118,  1.02968259,  1.071814  ,  1.11394541,  1.15607682,
1.19820823,  1.24033964,  1.28247105,  1.32460247,  1.36673388,
1.40886529,  1.4509967 ,  1.49312811,  1.53525952,  1.57739093,
1.61952234,  1.66165375,  1.70378516,  1.74591657,  1.78804799,
1.8301794 ,  1.87231081,  1.91444222,  1.95657363,  1.99870504,
2.04083645,  2.08296786,  2.12509927,  2.16723068,  2.20936209,
2.25149351,  2.29362492,  2.33575633,  2.37788774,  2.42001915,
2.46215056,  2.50428197,  2.54641338,  2.58854479,  2.6306762 ,
2.67280761,  2.71493903,  2.75707044,  2.79920185,  2.84133326,
2.88346467,  2.92559608,  2.96772749,  3.0098589 ,  3.05199031,
3.09412172,  3.13625313,  3.17838454,  3.22051596,  3.26264737,
3.30477878,  3.34691019,  3.3890416 ,  3.43117301,  3.47330442,
3.51543583,  3.55756724,  3.59969865,  3.64183006,  3.68396148,
3.72609289,  3.7682243 ,  3.81035571,  3.85248712,  3.89461853,
3.93674994,  3.97888135,  4.02101276,  4.06314417,  4.10527558,
4.147407  ]),
<BarContainer object of 200 artists>)
```

{{< figure src="/images/nyLAMf.png" >}}
